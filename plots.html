<!DOCTYPE html>
<html>
<title> Interactive Plots </title>

  <head>

    <style type="text/css">
      html, body, #map-canvas {height: 100%; margin: 0; padding: 0;}
    </style>

    <script type="text/javascript" src="jquery-2.1.3.min.js"></script>

    <script type="text/javascript"
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC4SPbDlN0XvyPEJFZhDhd8hQ0whisSD7Q&libraries=visualization&sensor=false">
    </script>

    <script type="text/javascript">

      //function setfocus() {document.myForm.x.focus();}

      function initialize() {

        document.myForm.oX.focus();

        var mapOptions = {
          center: {lat: 40.1430058, lng: -74.7311156},
          zoom: 7
        };

        var map = new google.maps.Map(document.getElementById('map-canvas'),
            mapOptions);

        // document.getElementById("finalname").innerHTML = final_str;
        // $("#myImg").attr("src",final_str);

        // $(document).ready(function(){
        //   $("button").click(function(){

        if (location.search) {

          // Get submitted parameters.
          var params = {};

          var parts = location.search.substring(1).split('&');

          for (var i = 0; i < parts.length; i++) {
              var nv = parts[i].split('=');
              params[i] = nv[1];
          }
        
          var x   = params[0];
          var y   = params[1];
          var typ = params[2];

          document.myForm.oX = x;
          document.myForm.oY = y;
          document.myForm.Type = typ;

          var str1 = "_png/";
          var str2 = ",";
          var str3 = ".png"

          var final_str = "./" + typ + str1 + x + str2 + y + str3;
          
          //var final_str = "./"+((((typ.concat(str1)).concat(x)).concat(str2)).concat(y)).concat(str3);

          $("#myImg").attr("src",final_str);

          var myLatlng = new google.maps.LatLng(38.9+parseInt(y)/138.2, -75.6+parseInt(x)/108.907);
          var marker = new google.maps.Marker({
              position: myLatlng,
              title: "("+x+","+y+")"
          });

          // Add the marker to the map.
          marker.setMap(map);

          // Label the marker.
          var infowindow = new google.maps.InfoWindow({
              content: "("+x+","+y+")"
          });
          infowindow.open(map,marker);
        }

        //   });
        // });

      }

      //oX = document.getElementById('oX');
      //oX.innerHTML = x;
      //oY = document.getElementById('oY');
      //oY.innerHTML = y;
      //typ = document.getElementById('typ');
      //typ.innerHTML = typ;

      google.maps.event.addDomListener(window, 'load', initialize);

    </script>
  </head>

  <!-- onload='initialize(); -->
  <body bgcolor="4C4646">

    <center>
    <h3 style="color:#F58025"> Interactive Arrival Rate Plots </h3>
    <form name=myForm METHOD=GET style="color:#FFFFFF">
    X: <input type=text name=oX size=2>
    Y: <input type=text name=oY size=2> <p>
    <!-- Time (hhm0): <input type=text name=Time size=4> <p> -->
    Arrival Type: <input type=radio name=Type value="indiv"> Individuals
                  <input type=radio name=Type value="units"> "Departure Units"
                  <input type=radio name=Type value="overlay" checked=checked> Overlay
    <br> <br>
    <button>Plot</button>

    <br><br>
    <a href="index.html" style="color: #52D017">Go to Interactive Arrival Rate Heat Map</a>
    <br><br>
    </center>

    <!-- <table cellspacing=0 border=0 width=75% cellpadding=10>
      <tr>
        <th>
        </th>
        <th>
        </th>
      </tr>
    </table> -->

    <!-- <img id="myImg" src="/overlay_png/125,65.png" alt="Select a Valid Pixel" style="width:660px;height:330px"> -->

    <div class="img" style:"float:left">
        <img id="myImg" src="/overlay_png/125,65.png" alt="Select a Valid Pixel" style="width:900px; height:450px">
    </div>
    <br>

    <!-- style="width: 30%; height: 45%; margin:0 auto" -->
    <div id="map-canvas" style="width: 30%; width: 300px; height: 450px; float: left; margin:0 auto"></div>

    <div id="footer">
      <center>
      <h5 style="color:#F58025">Kyle Douglas, 2015</h5>
      </center>
    </div>

  </body>
</html>